function startCross(e,t,r){e.registerImplementation("eui.IThemeAdapter",new CrossThemeAdapter),RES.registerAnalyzer(RES.ResourceItem.TYPE_XML,CrossJsonpXMLAnalyzer),RES.registerAnalyzer(RES.ResourceItem.TYPE_TEXT,CrossJsonpTextAnalyzer),RES.registerAnalyzer(RES.ResourceItem.TYPE_JSON,CrossJsonpJsonAnalyzer),RES.registerAnalyzer(RES.ResourceItem.TYPE_FONT,CrossJsonpFontAnalyzer),RES.registerAnalyzer(RES.ResourceItem.TYPE_SHEET,CrossJsonpSheetAnalyzer),$mCrossImage=t,$mResourcePath=r||"",t&&RES.registerAnalyzer(RES.ResourceItem.TYPE_IMAGE,CrossJsonpImageAnalyzer)}var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,r){function o(o){t.call(r,o,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?o(n):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Page0=function(e){function t(){var t=e.call(this)||this;return t.skinName="Page0Skin",t}return __extends(t,e),t.prototype.init=function(){this.jsonTf.text="来自json文件的数据:"+RES.getRes("test_json").nick,this.txtTf.text="来自txt文件的数据:"+RES.getRes("test_txt"),this.xmlTf.text="来自xml文件的数据:"+RES.getRes("test_xml").children[0].attributes.syntheticMaterial;var e=new egret.MovieClipDataFactory(RES.getRes("Dragon_json"),RES.getRes("Dragon_png")),t=new egret.MovieClip(e.generateMovieClipData("Dragon"));this.addChild(t),t.gotoAndPlay("walk",-1),t.x=320,t.y=800,t.scaleX=t.scaleY=1.5},t}(eui.Component);__reflect(Page0.prototype,"Page0");var Main=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.ADDED_TO_STAGE,t.__addedHandler,t),t}return __extends(t,e),t.prototype.__addedHandler=function(e){egret.Capabilities.isMobile||(this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL,this.stage.orientation=egret.OrientationMode.AUTO),this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter);var t=new RES.VersionController;t.getVirtualUrl=function(e){return e+"?v=0.0.1"},RES.registerVersionController(t),window&&window.needCross&&startCross(this.stage,!0,window.resourcePath),this.startLoadSource()},t.prototype.startLoadSource=function(){var e=this,t=new eui.Theme("resource/default.thm.json",this.stage);t.once(egret.Event.COMPLETE,function(t){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,function(e){RES.loadGroup("all")},e),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.sourceLoadOk,e),RES.loadConfig("resource/default.res.json","resource/")},this)},t.prototype.sourceLoadOk=function(e){var t=new Page0;t.init(),console.log("init"),this.addChild(t)},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var $mCrossImage=!1,$mResourcePath="",CrossThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,r,o){var e=RES.getVersionController().getVirtualUrl(e+".js");CrossJsonP.sendLocal(e,function(e,r){t.apply(o,[JSON.stringify(r)])},this)},e}();__reflect(CrossThemeAdapter.prototype,"CrossThemeAdapter",["eui.IThemeAdapter"]);var CrossJsonP=function(){function e(){}return e.sendLocal=function(t,r,o){e.mLocalCall[t]=[r,o];var n=document.createElement("script");n.src=$mResourcePath+t,document.body.appendChild(n)},e.localCallback=function(t,r){t=RES.getVersionController().getVirtualUrl(t),e.mLocalCall[t]?e.mLocalCall[t][0].apply(e.mLocalCall[t][1],[t,r]):(console.log(t),console.log(JSON.stringify(e.mLocalCall)),console.log("jsonp error:no call back of"+t))},e}();CrossJsonP.mLocalCall={},__reflect(CrossJsonP.prototype,"CrossJsonP");var CrossJsonpXMLAnalyzer=function(e){function t(){var t=e.call(this)||this;return t.mUrls={},t}return __extends(t,e),t.prototype.loadFile=function(e,t,r){if(this.fileDic[e.name])return void t.call(r,e);var o=RES.getVersionController().getVirtualUrl(e.url+".js");this.mUrls[o]={item:e,func:t,thisObject:r},CrossJsonP.sendLocal(o,this.onLoadOk,this)},t.prototype.onLoadOk=function(e,t){var r=this.mUrls[e];delete this.mUrls[e];var o=r.item,n=r.func;o.loaded=!0,o.loaded&&this.analyzeData(o,t),n&&n.call(r.thisObject,o)},t}(RES.XMLAnalyzer);__reflect(CrossJsonpXMLAnalyzer.prototype,"CrossJsonpXMLAnalyzer");var CrossJsonpTextAnalyzer=function(e){function t(){var t=e.call(this)||this;return t.mUrls={},t}return __extends(t,e),t.prototype.loadFile=function(e,t,r){if(this.fileDic[e.name])return void t.call(r,e);var o=RES.getVersionController().getVirtualUrl(e.url+".js");this.mUrls[o]={item:e,func:t,thisObject:r},CrossJsonP.sendLocal(o,this.onLoadOk,this)},t.prototype.onLoadOk=function(e,t){var r=this.mUrls[e];delete this.mUrls[e];var o=r.item,n=r.func;o.loaded=!0,o.loaded&&this.analyzeData(o,t),n&&n.call(r.thisObject,o)},t}(RES.TextAnalyzer);__reflect(CrossJsonpTextAnalyzer.prototype,"CrossJsonpTextAnalyzer");var CrossJsonpJsonAnalyzer=function(e){function t(){var t=e.call(this)||this;return t.mUrls={},t}return __extends(t,e),t.prototype.loadFile=function(e,t,r){if(this.fileDic[e.name])return void t.call(r,e);var o=RES.getVersionController().getVirtualUrl(e.url+".js");this.mUrls[o]={item:e,func:t,thisObject:r},CrossJsonP.sendLocal(o,this.onLoadOk,this)},t.prototype.onLoadOk=function(e,t){var r=this.mUrls[e];delete this.mUrls[e];var o=r.item,n=r.func;o.loaded=!0,o.loaded&&this.analyzeData(o,t),n&&n.call(r.thisObject,o)},t}(RES.JsonAnalyzer);__reflect(CrossJsonpJsonAnalyzer.prototype,"CrossJsonpJsonAnalyzer");var CrossJsonpFontAnalyzer=function(e){function t(){var t=e.call(this)||this;return t.mUrls={},t.mRecyclerIamge=[],t}return __extends(t,e),t.prototype.loadFile=function(e,t,r){if(this.fileDic[e.name])return void t.call(r,e);var o=RES.getVersionController().getVirtualUrl(e.url+".js");this.mUrls[o]={item:e,func:t,thisObject:r},CrossJsonP.sendLocal(o,this.onLoadOk,this)},t.prototype.onLoadOk=function(e,t){var r=this.mUrls[e];delete this.mUrls[e];var o=r.item,n=r.func;if(o.loaded=!0,o.loaded){o.loaded=!1;var s=this.analyzeConfig(o,t);if(s){if($mCrossImage)this.loadImgJson(s,o,n,r.thisObject);else{var a=this.mloadImage(s,r);this.resItemDic[a.hashCode]=r}return}}o.loaded&&n&&n.call(r.thisObject,o)},t.prototype.loadImgJson=function(e,t,r,o){var n=RES.getVersionController().getVirtualUrl(e+".js");this.mUrls[n]={item:t,func:r,thisObject:o},CrossJsonP.sendLocal(n,this.onImgJsonLoadOk,this)},t.prototype.onImgJsonLoadOk=function(e,t){var r=document.createElement("img");r.src=t;var o=this;r.onload=function(t){t.currentTarget.onload=null;var n=o.mUrls[e];delete o.mUrls[e];var s=n.item,a=n.func;s.loaded=!0;var i=new egret.Texture;i.bitmapData=new egret.BitmapData(r),o.analyzeBitmap(s,i),a.call(n.thisObject,s)}},t.prototype.onMLoad=function(e){var t=e.target,r=this.resItemDic[t.hashCode];delete this.resItemDic[t.hashCode];var o=r.item,n=r.func;if(o.loaded=e.type==egret.Event.COMPLETE,o.loaded){var s=new egret.Texture;s.bitmapData=new egret.BitmapData(t.data),this.analyzeBitmap(o,s)}this.mRecyclerIamge.push(t),o.loaded&&n.call(r.thisObject,o)},t.prototype.mloadImage=function(e,t){var r=this.mGetImageLoader();return this.resItemDic[r.hashCode]=t,r.load(RES.getVersionController().getVirtualUrl(e)),r},t.prototype.mGetImageLoader=function(){var e=this.mRecyclerIamge.pop();return e||(e=new egret.ImageLoader,e.addEventListener(egret.Event.COMPLETE,this.onMLoad,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onMLoad,this)),e},t}(RES.FontAnalyzer);__reflect(CrossJsonpFontAnalyzer.prototype,"CrossJsonpFontAnalyzer");var CrossJsonpSheetAnalyzer=function(e){function t(){var t=e.call(this)||this;return t.mUrls={},t.mRecyclerIamge=[],t}return __extends(t,e),t.prototype.loadFile=function(e,t,r){if(this.fileDic[e.name])return void t.call(r,e);var o=RES.getVersionController().getVirtualUrl(e.url+".js");this.mUrls[o]={item:e,func:t,thisObject:r},CrossJsonP.sendLocal(o,this.onLoadOk,this)},t.prototype.onLoadOk=function(e,t){var r=this.mUrls[e];delete this.mUrls[e];var o=r.item,n=r.func;if(o.loaded=!0,o.loaded){o.loaded=!1;var s=this.analyzeConfig(o,t);if(s){if($mCrossImage)this.loadImgJson(s,o,n,r.thisObject);else{var a=this.mloadImage(s,r);this.resItemDic[a.hashCode]=r}return}}o.loaded&&n&&n.call(r.thisObject,o)},t.prototype.loadImgJson=function(e,t,r,o){var n=RES.getVersionController().getVirtualUrl(e+".js");this.mUrls[n]={item:t,func:r,thisObject:o},CrossJsonP.sendLocal(n,this.onImgJsonLoadOk,this)},t.prototype.onImgJsonLoadOk=function(e,t){var r=document.createElement("img");r.src=t;var o=this;r.onload=function(t){t.currentTarget.onload=null;var n=o.mUrls[e];delete o.mUrls[e];var s=n.item,a=n.func;s.loaded=!0;var i=new egret.Texture;i.bitmapData=new egret.BitmapData(r),o.analyzeBitmap(s,i),a.call(n.thisObject,s)}},t.prototype.onMLoad=function(e){var t=e.target,r=this.resItemDic[t.hashCode];delete this.resItemDic[t.hashCode];var o=r.item,n=r.func;if(o.loaded=e.type==egret.Event.COMPLETE,o.loaded){var s=new egret.Texture;s.bitmapData=new egret.BitmapData(t.data),this.analyzeBitmap(o,s)}this.mRecyclerIamge.push(t),o.loaded&&n.call(r.thisObject,o)},t.prototype.mloadImage=function(e,t){var r=this.mGetImageLoader();return this.resItemDic[r.hashCode]=t,r.load(RES.getVersionController().getVirtualUrl(e)),r},t.prototype.mGetImageLoader=function(){var e=this.mRecyclerIamge.pop();return e||(e=new egret.ImageLoader,e.addEventListener(egret.Event.COMPLETE,this.onMLoad,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onMLoad,this)),e},t}(RES.SheetAnalyzer);__reflect(CrossJsonpSheetAnalyzer.prototype,"CrossJsonpSheetAnalyzer");var CrossJsonpImageAnalyzer=function(e){function t(){var t=e.call(this)||this;return t.mUrls={},t}return __extends(t,e),t.prototype.loadFile=function(e,t,r){if(this.fileDic[e.name])return void t.call(r,e);var o=RES.getVersionController().getVirtualUrl(e.url+".js");this.mUrls[o]={item:e,func:t,thisObject:r},CrossJsonP.sendLocal(o,this.onLoadOk,this)},t.prototype.onLoadOk=function(e,t){var r=document.createElement("img");r.src=t;var o=this;r.onload=function(t){t.currentTarget.onload=null;var n=o.mUrls[e];delete o.mUrls[e];var s=n.item,a=n.func;s.loaded=!0;var i=new egret.Texture;i.bitmapData=new egret.BitmapData(r),o.analyzeData(s,i),a.call(n.thisObject,s)}},t}(RES.ImageAnalyzer);__reflect(CrossJsonpImageAnalyzer.prototype,"CrossJsonpImageAnalyzer");